const http = require('http');
const fs=require('fs');
const querystring=require('querystring');
http.createServer((req,resp)=>{
  fs.readFile('html/form.html','utf-8',(error,data)=>{
        
      if(error){
         resp.writeHead(500,{"content-type" : 'text/plain'})
          resp.end('Internal server error')
           return;
        }
        if(req.url=='/'){
     resp.write(data);
        }
        else if(req.url=='/submit'){
          let dataBody=[];
          req.on('data',(chunk)=>{ //data is stored in nodejs in form of  chunks
            dataBody.push(chunk);

          });
          req.on('end',()=>{
            let rowdata=Buffer.concat(dataBody).toString();
            let readableData=querystring.parse(rowdata);
            let datastring="My name is"+readableData.name+"and my email id is:"+readableData.email;
            console.log(datastring);
            fs.writeFileSync("text/"+readableData.name+".txt",datastring);
            console.log("File Created");
          })
            resp.write('Form submitted')
        }
         resp.end();
    })
   
}).listen(3200)
